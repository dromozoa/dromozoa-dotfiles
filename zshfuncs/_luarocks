#compdef luarocks

_luarocks() {
  local curcontext="$curcontext"
  local context state state_descr line
  typeset -A opt_args

  local -a commands
  __dromozoa_setup_luarocks_commands

  local -a general_options
  __dromozoa_setup_luarocks_general_options

  _arguments -C \
    $general_options \
    ": :->command" \
    "*:: :->opt_or_arg"

  local ret
  ret=0
  case x$state in
    xcommand)
      _describe -t commands "luarock commands" commands
      ;;
    xopt_or_arg)
      _call_function ret "_luarocks_$words[1]"
      ;;
  esac
}

(( $+functions[_luarocks_remove] )) ||
_luarocks_remove() {
  local curcontext="$curcontext"
  local context state state_descr line
  typeset -A opt_args

  local -a general_options
  __dromozoa_setup_luarocks_general_options

  _arguments -C \
    $general_options \
    "--force" \
    "--force-fast"
}
